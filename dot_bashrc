# -*- mode: sh -*-
# vim: filetype=sh

# Source run commands only for interactive shells
[[ $- != *i* ]] && return

# Plugin manager
command -v sheldon &>/dev/null && eval "$(sheldon source)" # Load plugin manager

# Source local run commands
rc_file=~/.bashrc.local
[[ -f $rc_file ]] && source "$rc_file"
unset rc_file

# UI/UX
# TODO: Configure history file and settings
command -v nvim &>/dev/null && export EDITOR=nvim                                     # Default editor
command -v delta &>/dev/null && export DELTA_FEATURES=line-numbers                    # Feature to enable for delta
command -v difft &>/dev/null && export DFT_DISPLAY=inline                             # Display style for difftastic
command -v just &>/dev/null && export JUST_UNSTABLE=1                                 # Enable unstable just features # TODO: Remove this
command -v ripgrep &>/dev/null && export RIPGREP_CONFIG_PATH=~/.config/ripgrep/config # Ripgrep settings
command -v starship &>/dev/null && eval "$(starship init bash)"                       # Shell prompt

# Autocompletion
command -v carapace &>/dev/null && eval "$(carapace _carapace bash)" # Autocompletion
command -v pay-respects &>/dev/null && eval "$(pay-respects bash)"   # Autocorrection

# Fuzzy finder
if command -v fzf &>/dev/null; then
	export FZF_DEFAULT_OPTS=--reverse # Display style for fzf
	eval "$(fzf --bash)"
fi
command -v zoxide &>/dev/null && eval "$(zoxide init bash)" # Change directory
command -v atuin &>/dev/null && eval "$(atuin init bash)"   # History

# Environment manager
command -v direnv &>/dev/null && eval "$(direnv hook bash)"

# Aliases
# Define common aliases
if command -v yq &>/dev/null && command -v sd &>/dev/null; then
	eval "$(yq --output-format=shell ~/.alias.toml | sd '^(.+)' 'alias $1')"
fi
# Define Git aliases
eval "$(git config --get-regexp '^alias\.' | sd 'alias.(\w+) (!git )?(.+)' "alias g\$1='git \$3'")"
